---
title: "Copy-List-With-Random-Pointer"
question_id: "138"
question_link: "https://leetcode.com/problems/copy-list-with-random-pointer/description/"
difficulty: "Medium"
---

1. Given a linked list with length `n` that contains a additional pointer which points where each node points to a random value in the list including `null`
2. Return a deep copy of the list (Essentially just a straight up copy)

This question by itself without the random pointer is quite easy however the complexity becomes when the random pointer exists. Lets say we had copied all the way up to the third node, in the copied list everything after the third node does not exists yet the random pointer is supposed to point to some future node in the list. What do we do?

The though and solution I had was what if we preload all the nodes (Just the values) and focus on the random pointers after, which is actually quite effective that is the first pass. However how do we connect the nodes together afterwards? Well we can store the mapping inside a hash map where the `original_node -> copied_node`. We then use the map to connect the `next` and `random` pointers for each copied node. This ensures that all pointers are valid and no node is duplicated.


```python
"""
# Definition for a Node.
class Node:
    def __init__(self, x, next=None, random=None):
        self.val = int(x)
        self.next = next
        self.random = random
"""

class Solution(object):
    def copyRandomList(self, head):
        """
        :type head: Node
        :rtype: Node
        """
        oldToCopy = { None : None}

        current = head
        while current:
            copy = Node(current.val)
            oldToCopy[current] = copy
            current = current.next
        
        current = head
        while current: 
            copy = oldToCopy[current]
            copy.next = oldToCopy[current.next]
            copy.random = oldToCopy[current.random]
            current = current.next
        
        return oldToCopy[head]
```

> Time Complexity : `O(n)`
> 
> Space Complexity : `O(n)`